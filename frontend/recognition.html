<!DOCTYPE html>

<head>
    <title>Open Captions Overlay - Recognition</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-119887508-2"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-119887508-2');</script>
    
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/themes/nano.min.css">

    <link rel="stylesheet" href="{{ url_for('static', filename='css/common.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/recognition.css') }}">
</head>

<body>
    <div class="container">
        <div class="columns">
            <div class="column col-12">
                <div class="card custom-card">
                    <div class="card-body">
                        <div class="float-left d-flex" style="align-items: flex-end;">
                            <h4 class="mb-0 mr-2">OpenCaptionsOverlay</h4>
                            <img class="" src="https://img.shields.io/github/v/release/yf-dev/OpenCaptionsOverlay" />
                        </div>
                        <div class="float-right">
                            <a href="https://github.com/yf-dev/OpenCaptionsOverlay/blob/master/README.md" target="_blank" class="btn btn-link">사용방법</a>
                            <a href="https://github.com/yf-dev/OpenCaptionsOverlay" target="_blank" class="btn btn-link">GitHub</a>
                        </div>
                    </div>
                    
                </div>
            </div>
            <div class="column col-8 mt-4">
                <div class="card custom-card">
                    <div class="card-header">
                        <h3>오버레이</h3>
                        <div class="links">
                            <div>
                                <code>
                                    <a id="overlayNormal" target="_blank"
                                    href="{{ url_for('overlay', _external=True) }}?channel={{ current_user.twitch_id }}">{{ url_for('overlay', _external=True) }}?channel={{ current_user.twitch_id }}</a>
                                    <a id="overlaySans" class="hidden" target="_blank"
                                    href="{{ url_for('overlay_sans', _external=True) }}?channel={{ current_user.twitch_id }}">{{ url_for('overlay_sans', _external=True) }}?channel={{ current_user.twitch_id }}</a>
                                </code>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="mic-buttons">
                            <button id="micToggle" class="btn btn-success btn-sm" data-badge="&nbsp;">인식 시작</button>
                            <a class="btn btn-sm" href="{{ url_for('logout') }}">로그인 정보 갱신</a>
                            <button id="copy" class="btn btn-sm" data-badge="&nbsp;">오버레이 주소 복사</button>
                        </div>
                    </div>
                </div>
                <div class="card custom-card mt-4">
                    <div class="card-header">
                        <div class="card-title">
                            <h3 class="mb-2">최근인식결과</h3>
                            <h6 class="text-gray mb-0">마지막으로 인식된 결과를 표시합니다</h6>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="recognition-result">
                            <span id="finalStr"></span>
                            <span id="interim"></span>
                        </div>
                    </div>
                </div>
                <div class="card custom-card mt-4 mb-4">
                    <div class="card-header">
                        <div class="card-title">
                            <h3 class="mb-2">로그</h3>
                            <h6 class="text-gray mb-0">최대 300줄까지 최근 로그가 표시됩니다</h6>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="log-wrapper" id="logWrapper">
                            <table>
                                <tbody id="logBody"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="card-footer">
                        <span class="float-left text-gray">주의 : 화면을 새로고침하면 로그가 초기화됩니다</span>
                        <button class="btn btn-primary btn-sm float-right" onclick="downloadLog()">로그 다운로드</button>
                    </div>
                </div>
            </div>

            <div class="column col-4 mt-4">
                <div class="card custom-card">
                    <div class="card-header">
                        <h3 class="mb-2">설정</h3>
                        <h6 class="mb-0 text-gray">자막, 배경, 외곽선 세부 설정</h6>
                    </div>

                    <ul class="tab tab-block">
                        <li class="tab-item active" id="tabFont">
                          <a href="javascript:void(0);" onclick="toggleTab('font')">자막</a>
                        </li>
                        <li class="tab-item" id="tabBg">
                          <a href="javascript:void(0);" onclick="toggleTab('bg')">배경</a>
                        </li>
                        <li class="tab-item" id="tabBorder">
                          <a href="javascript:void(0);" onclick="toggleTab('border')">외곽선</a>
                        </li>
                        <li class="tab-item" id="tabEtc">
                            <a href="javascript:void(0);" onclick="toggleTab('etc')">실험실</a>
                          </li>
                    </ul>

                    <div class="card-body setting-card" id="settingFont">
                    
                        <div class="columns">
                            <div class="column col-4">
                                <label class="form-label" for="settingTextFont">폰트</label>
                            </div>
                            <div class="column col-7 col-ml-auto">
                                <select class="form-select" id="settingTextFont">
                                    <option>배달의민족 주아체</option>
                                    <option>Slack</option>
                                    <option>Skype</option>
                                    <option>Hipchat</option>
                                </select>
                            </div>
                        </div>

                    
                        <div class="columns mt-3">
                            <div class="column col-4">
                                <label class="form-label" for="settingTextSize">크기</label>
                            </div>
                            <div class="column col-7 col-ml-auto">
                                <div class="input-group">
                                    <input type="number" class="form-input" placeholder="16" value="16" min="1" max="100" id="settingTextSize">
                                    <span class="input-group-addon">px</span>
                                </div>
                            </div>
                        </div>

                        <div class="columns mt-3">
                            <div class="column col-4">
                                <label class="form-label" for="settingTextBold"><b>굵게</b></label>
                            </div>
                            <div class="column col-2 col-ml-auto">
                                <label class="form-switch">
                                    <input type="checkbox" id="settingTextBold">
                                    <i class="form-icon"></i>
                                </label>
                            </div>
                        </div>

                        <div class="columns mt-3">
                            <div class="column col-4">
                                <label class="form-label" for="settingTextItalic"><i>기울임</i></label>
                            </div>
                            <div class="column col-2 col-ml-auto">
                                <label class="form-switch">
                                    <input type="checkbox" id="settingTextItalic">
                                    <i class="form-icon"></i>
                                </label>
                            </div>
                        </div>


                    </div>

                    <div class="card-body setting-card d-none" id="settingBg">
                        <div class="columns mt-3">
                            <div class="column col-4">
                                <label class="form-label" for="settingTextItalic">색상</label>
                            </div>
                            <div class="column col-4 col-ml-auto">
                                <label class="form-label float-right"><b>#000000</b></label>
                            </div>
                        </div>
                        <div class="color-picker-bg"></div>

                        <div class="columns mt-3">
                            <div class="column col-4">
                                <label class="form-label" for="settingTextItalic">투명도</label>
                            </div>
                            <div class="column col-4 col-ml-auto">
                                <label class="form-label float-right"><b>100%</b></label>
                            </div>
                        </div>
                        <input class="slider tooltip" type="range" min="0" max="100" value="100" oninput="this.setAttribute('value', this.value);">        
                    </div>

                    <div class="card-body setting-card d-none" id="settingBorder">
                        <div class="columns mt-3">
                            <div class="column col-4">
                                <label class="form-label" for="settingTextItalic">색상</label>
                            </div>
                            <div class="column col-4 col-ml-auto">
                                <label class="form-label float-right"><b>#000000</b></label>
                            </div>
                        </div>
                        <div class="color-picker-border"></div>

                        <div class="columns mt-3">
                            <div class="column col-4">
                                <label class="form-label" for="settingTextItalic">굵기</label>
                            </div>
                            <div class="column col-4 col-ml-auto">
                                <label class="form-label float-right"><b>2px</b></label>
                            </div>
                        </div>
                        <input class="slider tooltip" type="range" min="0" max="10" value="2" oninput="this.setAttribute('value', this.value);">

                        <h6 class="mt-4">스타일</h6>
                        <div class="form-group">
                            <label class="col-4 form-radio form-inline">
                                <input type="radio" name="border-radius">
                                <i class="form-icon"></i> 각진
                            </label>
                            <label class="col-4 form-radio form-inline">
                                <input type="radio" name="border-radius">
                                <i class="form-icon"></i> 둥근
                            </label>
                            <label class="col-3 form-radio form-inline">
                                <input type="radio" name="border-radius">
                                <i class="form-icon"></i> 원형
                            </label>
                        </div>
                    </div>

                    <div class="card-body setting-card d-none" id="settingEtc">
                        <div class="d-flex">
                            <label class="form-switch">
                                <input type="checkbox" id="sansModeToggle">
                                <i class="form-icon"></i> WA!
                            </label>
                            <input id="sansVolume" class="slider hidden" type="range" min="0" max="100" value="100">
                        </div>
                    </div>

                </div>
                <div class="float-right">
                    <a href="https://github.com/yf-dev/OpenCaptionsOverlay/blob/master/LICENSE" target="_blank" class="btn btn-link">© MIT License</a>
                </div>
            </div>
        </div>
    </div>
    <!-- <script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/pickr.min.js"></script>

    <script> const HOST = "{{ host }}"; </script>

    <script type="text/javascript" src="{{ url_for('static', filename='js/common.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/recognition.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/recognition-setting.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/recognition-log.js') }}"></script>

    <script>
        (function() {
            appendLog("system", "Ready");
        })();
    </script>
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    
        {% for category, message in messages %}
        <script>
            appendLog("system", "{{ message }}");
        </script>
        {% endfor %}
    
    {% endif %}
    {% endwith %}
</body>